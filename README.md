# 高光谱图像降维算法实现

## 项目简介
本项目实现了基于张量低秩稀疏学习（tLTSL）高光谱图像降维算法。通过张量分解和流形学习等技术，实现对高光谱图像的特征提取与降维，为后续的地物分类等任务提供更有效的特征表示。

## 主要文件说明

### 1. `tensor_function.py`
包含核心张量操作和降维相关函数：
- `Patch()`: 从高光谱图像中提取局部patch
- `dist()`: 计算样本间距离并构建邻接矩阵
- `fold()`/`unfold()`: 张量的折叠与展开操作
- `kmode_product()`: 张量的模式-n乘积
- `getU()`: 基于MTLPP算法计算各模式的投影矩阵
- `train_test_tensor_half()`/`train_test_tensor_fold()`: 训练集和测试集的划分与预处理

### 2. `tLTSL.py`
实现张量低秩稀疏学习（tLTSL）算法：
- `TRPCA`类：实现张量鲁棒主成分分析
  - `ADMM()`: 交替方向乘子法求解优化问题
  - `T_product()`: 张量-张量乘积操作
  - `SVDShrink()`/`SoftShrink()`: 奇异值阈值和软阈值操作
- 高光谱图像加载、预处理与降维流程

## 算法原理
1. **TRPCA去噪**：利用张量的低秩性和稀疏性，将高光谱图像分解为低秩分量（主要特征）和稀疏分量（噪声）
2. **张量降维**：通过多模式张量乘积，在保持空间结构和光谱特性的同时降低维度
3. **流形学习**：利用局部保留投影原理，在降维过程中保持样本的局部邻域关系

## 使用方法
1. 准备高光谱图像数据（.mat格式）
2. 在`tLTSL.py`中修改数据加载路径：
   ```python
   image=loadmat('./WHU_Hi_LongKou.mat')['WHU_Hi_LongKou']
   label=loadmat('./WHU_Hi_LongKou_gt.mat')['WHU_Hi_LongKou_gt']
   ```
3. 调整算法参数（如降维维度、patch大小等）
4. 运行`tLTSL.py`执行降维流程

## 依赖环境
- Python 3.x
- NumPy
- PyTorch
- SciPy
- scikit-learn
- spectral

## 注意事项
- 数据路径需根据实际文件位置进行修改
- 可通过调整`TRPCA`类中的参数（如`r`、`max_iters`等）优化降维效果
- 训练集比例可通过随机索引文件进行控制

该算法特别适用于高光谱遥感图像的特征提取与降维，能够有效保留空间-光谱联合特征，为后续分类任务提供更优的输入特征。
